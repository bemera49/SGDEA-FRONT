<form [formGroup]="moduleForm" class="form-horizontal" (ngSubmit)="submitForm()">

  <div class="row">

    <!-- Header -->
    <div class="modal-header col-lg-12 col-md-12 col-sm-12 col-xs-12 mb-2">
      <h4 class="modal-title w-100" id="myModalLabel">
        <mat-label><b> {{ textFormHeader | translate }} </b></mat-label>
        <!-- <a style="float: right; color:#365c8a !important;" [routerLink]="routeCreateFolder" (click)="closeDialog()">{{
          'Crear expediente' | translate }}</a> -->
      </h4>
      <button mat-button type="button" (click)="closeDialog()" title="{{ 'Cerrar' | translate }}" class="close"
        data-dismiss="alert" aria-label="Close">
        <i class="material-icons">close</i>
      </button>
    </div>
    <!-- /Header -->

    <!-- Body -->
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
      <p>{{ 'Buscar Expediente' | translate }}</p>
    </div>

    <!-- <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <mat-card-content>
                <label>{{ tittleSelectTipoExpeidiente | translate }}</label>
                <section class="example-section">
                    <mat-slide-toggle formControlName="newFile" (change)="MatSlideToggleChange($event)" class="" [color]="color">
                        {{ messageSelectTipoExpeidiente | translate }}
                    </mat-slide-toggle>
                </section>
            </mat-card-content>
        </div> -->



    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Dependencia" | translate }}</mat-label>
        <mat-select (selectionChange)="getListSeriesId($event.value)" id="idGdTrdDependencia"
          formControlName="idGdTrdDependencia" name="idGdTrdDependencia">
          <mat-option *ngFor="let dep of dependencia" [value]="dep.id">
            {{dep.val}}</mat-option>
        </mat-select>
        <mat-error *ngIf="
                      !moduleForm.get('idGdTrdDependencia').valid &&
                      moduleForm.get('idGdTrdDependencia').touched
                    ">{{ "El campo es obligatorio" | translate }}</mat-error>
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "selectSerie" | translate }}</mat-label>
        <mat-select (selectionChange)="setIdSeries($event.value)" id="idGdTrdSerie" formControlName="idGdTrdSerie"
          name="idGdTrdSerie">
          <mat-option *ngFor="let dep of series " [value]="dep.id">
            {{dep.val}}</mat-option>
        </mat-select>
        <mat-error *ngIf="!moduleForm.get('idGdTrdSerie').valid && moduleForm.get('idGdTrdSerie').touched">
          {{ "El campo es obligatorio" | translate }}
        </mat-error>
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "selectSubserie" | translate }}</mat-label>
        <mat-select id="idGdTrdSubserie" formControlName="idGdTrdSubserie" name="idGdTrdSubserie">
          <mat-option *ngFor="let sub of subSeries " [value]="sub.id">
            {{sub.val}}</mat-option>
        </mat-select>
        <mat-error *ngIf="!moduleForm.get('idGdTrdSubserie').valid && moduleForm.get('idGdTrdSubserie').touched">{{
          "El campo es obligatorio" | translate }}</mat-error>
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ 'Nombre expediente' | translate }}</mat-label>
        <input matInput type="text" formControlName="nombreGdExpediente" maxlength="80">
        <mat-error
          *ngIf="!moduleForm.get( 'nombreGdExpediente').valid || moduleForm.get( 'nombreGdExpediente').touched ">
          {{ 'El campo es obligatorio' | translate }}.
        </mat-error>
      </mat-form-field>
    </div>


    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Estado" | translate }}</mat-label>
        <mat-select id="status" formControlName="status" name="status">
          <mat-option [value]="10">activo</mat-option>
          <mat-option [value]="0">inactivo</mat-option>
        </mat-select>
        <mat-error *ngIf="!moduleForm.get('status').valid && moduleForm.get('status').touched">{{
          "El campo es obligatorio" | translate }}</mat-error>
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Fase de archivo" | translate }}</mat-label>
        <mat-select id="idFase" formControlName="idFase" name="idFase">
          <mat-option [value]="1">Archivo de Gestión</mat-option>
          <mat-option [value]="2">Archivo Central</mat-option>
          <mat-option [value]="3">Archivo Histórico</mat-option>

        </mat-select>
        <!--                     <mat-error
          *ngIf="!moduleForm.get('estadoGdExpediente').valid && moduleForm.get('estadoGdExpediente').touched">{{
          "El campo es obligatorio" | translate }}</mat-error> -->
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Usuario creador" | translate }}</mat-label>
        <input matInput formControlName="user" maxlength="80" />

        <!-- <mat-error *ngIf="
                !moduleForm.get('fechaProcesoGdExpedie2nte').valid &&
                moduleForm.get('fechaProcesoGdExpediente').touched
              ">
          {{ "El campo es obligatorio" | translate }}.
        </mat-error> -->
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Fecha inicio " | translate }}</mat-label>
        <input matInput id="fechaInicial" name="fechaInicial" [min]="minDate" [max]="maxDate"
          formControlName="fechaInicial" [matDatepicker]="picker1" placeholder="{{ 'Ingrese una fecha' | translate }}"
          (click)="picker1.open()" />
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker touchUi #picker1></mat-datepicker>
        <mat-error *ngIf="
                !moduleForm.get('fechaInicial').valid &&
                moduleForm.get('fechaInicial').touched
              ">
          {{ "Este campo no acepta caracteres" | translate }}.
        </mat-error>
      </mat-form-field>
    </div>

    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ "Fecha final " | translate }}</mat-label>
        <input matInput id="fechaFinal" name="fechaFinal" [min]="minDate" [max]="maxDate" formControlName="fechaFinal"
          [matDatepicker]="picker2" placeholder="{{ 'Ingrese una fecha' | translate }}" (click)="picker2.open()" />
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker touchUi #picker2></mat-datepicker>
        <mat-error *ngIf="
                !moduleForm.get('fechaFinal').valid &&
                moduleForm.get('fechaFinal').touched
              ">
          {{ "Este campo no acepta caracteres" | translate }}.
        </mat-error>
      </mat-form-field>
    </div>

    <!-- <div
      [ngClass]="{'col-lg-6 col-md-6 col-sm-12 col-xs-12': isNuevoExpediente == true, 'col-lg-5 col-md-5 col-sm-12 col-xs-12': isNuevoExpediente == false}">
      <mat-form-field>
        <mat-label>{{ 'Número expediente' | translate }}</mat-label>
        <input matInput type="text" formControlName="numeroExpediente" maxlength="20">
        <mat-error *ngIf="!moduleForm.get( 'numeroExpediente').valid || moduleForm.get( 'numeroExpediente').touched ">
          {{ 'El campo es obligatorio' | translate }}.
        </mat-error>
      </mat-form-field>
    </div> -->

    <ng-container *ngIf=" metadatos &&  metadatos.length > 0">
      <div class="col-12">
        <p>{{ 'Meta datos' | translate }}</p>
      </div>

      <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12" *ngFor="let metadata of metadatos; let i = index">
        <mat-form-field>
          <mat-label>{{ metadata.nombre | translate }}</mat-label>
          <input matInput [type]="metadata.tipo" [formControlName]="'metadata_' + metadata.id"
            formControlName="{{ metadata.nombre }}" placeholder="{{ 'ingrese' + metadata.nombre | translate }}"
            maxlength="250" />
          <mat-error
            *ngIf="!moduleForm.get('metadata_' + metadata.id)?.valid && moduleForm.get('metadata_' + metadata.id)?.touched">
            {{ "El campo es obligatorio" | translate }}
          </mat-error>
        </mat-form-field>
      </div>

    </ng-container>


    <!-- 
    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ 'Nombre Serie' | translate }}</mat-label>
        <input matInput type="text" formControlName="nombreGdTrdSerie" maxlength="80">
        <mat-error *ngIf="!moduleForm.get( 'nombreGdTrdSerie').valid || moduleForm.get( 'nombreGdTrdSerie').touched ">
          {{ 'El campo es obligatorio' | translate }}.
        </mat-error>
      </mat-form-field>
    </div> -->

    <!-- <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
      <mat-form-field>
        <mat-label>{{ 'Nombre Subserie' | translate }}</mat-label>
        <input matInput type="text" formControlName="nombreGdTrdSubserie" maxlength="80">
        <mat-error
          *ngIf="!moduleForm.get( 'nombreGdTrdSubserie').valid || moduleForm.get( 'nombreGdTrdSubserie').touched ">
          {{ 'El campo es obligatorio' | translate }}.
        </mat-error>
      </mat-form-field>
    </div>
 -->
    <div *ngIf="!isNuevoExpediente" style="text-align: right;" class="col-lg-1 col-md-1 col-sm-12 col-xs-12">
      <button mat-raised-button class="btn btn-primary btn-round" type="button" (click)="searchExpedientes()">
        <span>
          Buscar
        </span>
      </button>
    </div>

    <div *ngIf="!isNuevoExpediente" style="text-align: right;  margin-left: 30px;"
      class="col-lg-1 col-md-1 col-sm-12 col-xs-12">
      <button mat-raised-button class="btn btn-primary btn-round" type="button" (click)="reset()">
        <span>
          Limpiar
        </span>
      </button>
    </div>

    <!-- [disabled]="!(moduleForm.get( 'numeroExpediente').value.length > '2') && !(moduleForm.get( 'nombreExpediente').value.length > '2') && !(moduleForm.get( 'nombreGdTrdSerie').value.length > '2') && !(moduleForm.get( 'nombreGdTrdSubserie').value.length > '2')" -->

    <ng-container *ngIf="dataExp.length > 0">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-2">
        <section class="textFormObservaHeader">{{ 'Listado de expedientes' | translate }}</section>
        <div class="clickable-list">
          <app-table-exp [data]="dataExp" (onExp)="onChangeExp($event)"></app-table-exp>

          <!-- <div *ngFor="let expediente of filteredlistExpedientes | async">
            <label class="text-primary">
              <input type="checkbox" [value]="expediente.id" (change)="onChangeExp($event.target.checked, expediente.id)">
              {{ expediente.val }}
            </label>
          </div> -->
        </div>
        <!-- <mat-error *ngIf="!moduleForm.get('idExpediente').valid && moduleForm.get('idExpediente').touched">
          {{ 'El campo es obligatorio' | translate }}
        </mat-error> -->
      </div>
    </ng-container>
    <!-- /Body -->

  </div>

  <!-- Footer -->
  <div *ngIf="dataExp.length > 0" mat-dialog-actions style="float: right !important;">
    <!-- [disabled]="!moduleForm.valid" -->
    <button mat-raised-button class="btn btn-primary btn-round" type="submit">
      Incluir documento
    </button>
  </div>
  <!-- /Footer -->

</form>
<!-- <app-doc-manag-folder-create *ngIf="statusCreateFolder" (closeFolderEmiter)="closeDialog($event)"></app-doc-manag-folder-create> -->