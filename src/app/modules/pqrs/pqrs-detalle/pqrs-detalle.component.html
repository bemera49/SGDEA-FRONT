<app-breadcrumb [breadcrumbOn]="breadcrumbOn" [breadcrumbRouteActive]="breadcrumbRouteActive"></app-breadcrumb>

<!-- detalle PQRS -->
<div class="card ml-3 " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">description</i>
        </div>
        <h4 class="card-title">
            Detalle PQRS {{ currentItem.numeroRadiRadicado }}
        </h4>
    </div>

    <form [formGroup]="pqrsForm" class="row mt-2">
        <span class="col-md-4 col-lg-4">
            <label>Número de cuenta contrato</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Número de cuenta contrato" matInput formControlName="numeroCuentaContrato" />
                <mat-error *ngIf="
                  pqrsForm.controls['numeroCuentaContrato'].invalid &&
                  pqrsForm.controls['numeroCuentaContrato'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Estado del vencimiento</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Estado del vencimiento" matInput formControlName="estadoRadiRadicado" />
                <mat-error *ngIf="
                  pqrsForm.controls['estadoRadiRadicado'].invalid &&
                  pqrsForm.controls['estadoRadiRadicado'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Número de contacto</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Número de contacto" matInput formControlName="contactoSap" />
                <mat-error *ngIf="
                  pqrsForm.controls['contactoSap'].invalid &&
                  pqrsForm.controls['contactoSap'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Fecha de radicación</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Fecha de radicación" matInput formControlName="creacionRadiRadicado" />
                <mat-error *ngIf="
                  pqrsForm.controls['creacionRadiRadicado'].invalid &&
                  pqrsForm.controls['creacionRadiRadicado'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Tipo de solicitud</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Tipo de solicitud" matInput formControlName="tipo_solicitud" />
                <mat-error *ngIf="
                  pqrsForm.controls['tipo_solicitud'].invalid &&
                  pqrsForm.controls['tipo_solicitud'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Canal</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Canal" matInput formControlName="cg_medio_recepcion" />
                <mat-error *ngIf="
                  pqrsForm.controls['cg_medio_recepcion'].invalid &&
                  pqrsForm.controls['cg_medio_recepcion'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Clasificación Interna</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Clasificación Interna" matInput formControlName="clasificacionInternaId" />
                <mat-error *ngIf="
                  pqrsForm.controls['clasificacionInternaId'].invalid &&
                  pqrsForm.controls['clasificacionInternaId'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Fecha de asignación</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Fecha de asignación" matInput formControlName="asignacionRadiRadicado" />
                <mat-error *ngIf="
                  pqrsForm.controls['asignacionRadiRadicado'].invalid &&
                  pqrsForm.controls['asignacionRadiRadicado'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Usuario que asignó</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Usuario que asignó" matInput formControlName="user_idTramitador" />
                <mat-error *ngIf="
                  pqrsForm.controls['user_idTramitador'].invalid &&
                  pqrsForm.controls['user_idTramitador'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Fecha de solicitud</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Fecha de solicitud" matInput formControlName="fechaDocumentoRadiRadicado" />
                <mat-error *ngIf="
                  pqrsForm.controls['fechaDocumentoRadiRadicado'].invalid &&
                  pqrsForm.controls['fechaDocumentoRadiRadicado'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Usuario que solicita</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Usuario que solicita" matInput formControlName="user_idCreador" />
                <mat-error *ngIf="
                  pqrsForm.controls['user_idCreador'].invalid &&
                  pqrsForm.controls['user_idCreador'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>


        <span class="col-md-4 col-lg-4">
            <label>Usuario que rechazó</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Usuario que rechazó" matInput formControlName="rejectUser" />
                <mat-error *ngIf="
                  pqrsForm.controls['rejectUser'].invalid &&
                  pqrsForm.controls['rejectUser'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>
        <span class="col-md-4 col-lg-4">
            <label>Fecha de rechazo</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Fecha de rechazo" matInput formControlName="rejectDate" />
                <mat-error *ngIf="
                  pqrsForm.controls['rejectDate'].invalid &&
                  pqrsForm.controls['rejectDate'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>

        <span class="col-md-4 col-lg-4">
            <label>Causal de rechazo</label>
            <mat-form-field appearance="outline" class="w-100">
                <input placeholder="Causal de rechazo" matInput formControlName="rejectCause" />
                <mat-error *ngIf="
                  pqrsForm.controls['rejectCause'].invalid &&
                  pqrsForm.controls['rejectCause'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>
        <span class="col-md-12 col-lg-12">
            <label>Observaciones</label>
            <mat-form-field appearance="outline" class="w-100">
                <textarea placeholder="Causal de notificación" matInput formControlName="observations" rows="3">
              </textarea>
                <mat-error *ngIf="
                  pqrsForm.controls['observations'].invalid &&
                  pqrsForm.controls['observations'].touched
                ">
                    Este campo es requerido
                </mat-error>
            </mat-form-field>
        </span>
    </form>
</div>
<!-- detalle PQRS -->

<!-- ANEXOS -->
<div class="card ml-3  " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">description</i>
        </div>
        <h4 class="card-title">
            Anexos
        </h4>
    </div>
    <div class="d-flex flex-row mb-4 w-100  flex-wrap ">
        <div *ngFor="let doc of anexos" class="border rounded d-flex py-2 px-1 mt-1 flex-row align-items-center mr-2"
            style="max-width: max-content; gap: 2px">
            <img src="assets/img/pdf-icon.svg" />
            <div class="text-pdf">{{ doc.nombreRadiDocumento }}</div>
            <button class="button-pdf" (click)="downloadFile(doc)">
                <mat-icon>download</mat-icon>
            </button>
        </div>
    </div>
</div>
<!-- ANEXOS -->

<!-- trazabilidad -->
<div class="card ml-3 " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">date_range</i>
        </div>
        <h4 class="card-title">{{ 'Trazabilidad del radicado' | translate }}</h4>
    </div>

    <div class="card-body ">

        <!-- Row 1 -->
        <div class="row ">
            <div *ngFor="let dataHist of ( dataRowsHistorico ? dataRowsHistorico.slice(0, numberLimitHistory) : [] );"
                class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <!-- Line component -->
                <div class="line text-muted"></div>
                <h5 class="card-title" style="color:#365c8a">
                    <span class="material-icons">
                        {{ dataHist.iconTrans ? dataHist.iconTrans : "date_range" }}
                    </span> {{ dataHist.transaccion | translate }}

                    <br class="style-none">
                    <small class="description margin-left">{{ dataHist.fecha }}</small>
                </h5>
                <p class="marginHistory"><small class="description">{{ 'Usuario' | translate }}: </small> {{
                    dataHist.usuario }}</p>
                <p class="marginHistory"><small class="description">{{ 'Dependencia' | translate }}: </small> {{
                    dataHist.dependencia }}</p>
                <p class="marginHistory"><small class="description">{{ 'Observación' | translate }}: </small> {{
                    dataHist.observacion }}</p>
            </div>
            <!-- Start See more -->
            <div *ngIf="statusSeeMoreHistory" class=" moreHistory col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <a *ngIf="statusSeeHistory" (click)="seeMoreAndLess(statusSeeHistory, 'History')">{{ 'Ver más' |
                    translate }}</a>
                <a *ngIf="!statusSeeHistory" (click)="seeMoreAndLess(statusSeeHistory, 'History')">{{ 'Ver menos' |
                    translate }}</a>
            </div>
            <!-- End See more -->
        </div>
        <!-- Row 1 -->

    </div>
</div>
<!-- trazabilidad -->

<!--HU 13, ASOCIAR DOCUMENTOS A LA PQRS-->
<div *ngIf="selectedExpedientes && selectedExpedientes.length > 0" class="card ml-3  " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">description</i>
        </div>
        <h4 class="card-title">
            Expedientes Seleccionados
        </h4>
    </div>
    <ng-container>
        <table class="table border border-2 rounded">
            <thead>
                <tr>
                    <th class="text-body-tertiary font-weight-bold px-5">#</th>
                    <th class="text-body-tertiary font-weight-bold">Nombre</th>
                    <th class="text-body-tertiary font-weight-bold">Peso</th>
                    <th class="text-body-tertiary font-weight-bold">Símbolo</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let exp of selectedExpedientes; let i = index">
                    <td class="px-5">{{ i + 1 }}</td>
                    <td>{{ exp.name }}</td>
                    <td>{{ exp.weight }}</td>
                    <td>{{ exp.symbol }}</td>
                </tr>
            </tbody>
        </table>
    </ng-container>
</div>

<!-- AMPLIACION DE TERMINOS -->
<!-- <div class="card ml-3  " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">description</i>
        </div>
        <h4 class="card-title">
            Ampliación de terminos
        </h4>
    </div>
    <ng-container *ngIf="infoArrayProrroga && infoArrayProrroga.length > 0">
        <div *ngFor="let item of infoArrayProrroga">
            <div class="container-terminos-aprobado">
                <inputs>
                    <mat-label>Tipo de solicitud de autorización</mat-label>
                    <mat-form-field appearance="outline">
                        <input value="Solicitar Amplición de Términos" matInput disabled="true" />
                    </mat-form-field>
                </inputs>
                <inputs *ngIf="item.estado !== 'Pendiente'">
                    <mat-label>Usuario Aprobador</mat-label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input matInput value="{{item.autorizador.full_name}}" disabled="true" />
                    </mat-form-field>
                </inputs>
                <inputs>
                    <mat-label>Tiempo de ampliación de términos en días</mat-label>
                    <mat-form-field appearance="outline">
                        <input value="{{item.diasAmpliacionTerminos}}" matInput disabled="true" />
                    </mat-form-field>
                </inputs>
                <inputs *ngIf="item.estado === 'Pendiente'">
                    <mat-label>Justificación</mat-label>
                    <mat-form-field appearance="outline" class="w-100">
                        <textarea matInput value="{{item.observaciones}}" disabled="true"></textarea>
                    </mat-form-field>
                </inputs>
                <inputs *ngIf="item.estado === 'Aprobada'">
                    <mat-label>Estado</mat-label>
                    <mat-form-field appearance="outline">
                        <input value="Ampliacion de términos aprobada" matInput disabled="true" />
                    </mat-form-field>
                </inputs>
                <inputs *ngIf="item.estado === 'Rechazada'">
                    <mat-label>Estado</mat-label>
                    <mat-form-field appearance="outline">
                        <input value="Ampliacion de términos rechazada" matInput disabled="true" />
                    </mat-form-field>
                </inputs>
            </div>
            <inputs *ngIf="item.estado === 'Rechazada'">
                <mat-label>Causales de rechazo</mat-label>
                <mat-form-field appearance="outline">
                    <input value="{{item.motivo_rechazo}}" matInput disabled="true" />
                </mat-form-field>
            </inputs>
        </div>
    </ng-container>
</div> -->
<!-- AMPLIACION DE TERMINOS -->

<!--HU 11 - Aparece al presionar el botón asociar documento o expediente,
    desaparece al seleccionar los expedientes, al cerrar el modal -->
<app-initial-list *ngIf="isExpedienteListVisible" [initCardHeaderStatus]="initCardHeaderStatus"
    [initCardHeaderIcon]="initCardHeaderIcon" [initCardHeaderTitle]="initCardHeaderTitleExpedientes"
    [dtTitles]="dtTitlesExpedientes" [routeLoadDataTablesService]="routeLoadDataTablesExpedientes"
    (selectedRowsEmiter)="selectedRowsReceiveDataExpediente($event)" [routeData]="'LogPqrs'">
</app-initial-list>

<!-- HU 11 - Es la información de los expedientes seleccionados, reemplaza el
    lugar de la tabla al haber asociado los expedientes, todo este flujo es si
    se activa el boton de asociar documento o expediente -->
<div *ngIf="isAssociatedExpedientesVisible" class="card ml-3  " style="width: 93%">
    <div class="card-header card-header-info card-header-icon">
        <div class="card-icon">
            <i class="material-icons">description</i>
        </div>
        <h4 class="card-title">
            Expedientes asociados
        </h4>
    </div>
    <ng-container>
        <div class="my-4">
            <div class="row" style="gap: 5px 0px">
                <span class="col-md-6">
                    <h5 class="text-body-tertiary font-weight-bold m-0">Expediente</h5>
                    <p class="col-md-6 p-0">Texto</p>
                </span>
                <span class="col-md-6">
                    <h5 class="text-body-tertiary font-weight-bold m-0">Serie</h5>
                    <p class="col-md-6 p-0">Texto</p>
                </span>
                <span class="col-md-6">
                    <h5 class="text-body-tertiary font-weight-bold m-0">Subserie</h5>
                    <p class="col-md-12 p-0">Texto</p>
                </span>
                <span class="col-md-6">
                    <h5 class="text-body-tertiary font-weight-bold m-0">
                        Tipo documental
                    </h5>
                    <p class="col-md-12 p-0">Texto</p>
                </span>
            </div>
        </div>
    </ng-container>
</div>

<!-- cuentas contrato asociadas -->
<!-- Abrir el dialog/modal Creación de contactos HU030 PQRS  -->
<!-- *can="['pqrs%cuentas%contrato%radicado']" -->
<div class="d-flex justify-content-center">
    <button class="btn btn-primary text-center modal-button" (click)="openDialogCreacionContactos()">
        Gestionar cuentas contrato
    </button>
</div>
<app-initial-list [showButtonFiltrer]="showButtonFiltrer" [initCardHeaderStatus]="initCardHeaderStatus"
    [initCardHeaderIcon]="initCardHeaderIcon" [dtTitles]="dtTitlesOtras"
    [routeLoadDataTablesService]="routeLoadDataTablesServiceOtras" [initCardHeaderTitle]="initCardHeaderTitleOtras"
    [routeData]="'radi-radicados-cuenta-contrato'" [NoDecrypt]="true" [isredirectionPath]="false"
    [sweetLoadingInitStatus]="false" [viewColumStatus]="false"></app-initial-list>
<!-- cuentas contrato asociadas -->

<!-- cuentas contrato asociadas -->
<app-initial-list [showButtonFiltrer]="showButtonFiltrer" [initCardHeaderStatus]="initCardHeaderStatus"
    [initCardHeaderIcon]="initCardHeaderIcon" [dtTitles]="dtTitlesRadicadosAsociados"
    [routeLoadDataTablesService]="routeLoadDataTablesServiceRadicadosAsociados"
    [initCardHeaderTitle]="initCardHeaderTitleRadicadosAsociados" (selectedRowsEmiter)="selectedRowsReceiveData($event)"
    [routeData]="'asociar-solicitudes'" [NoDecrypt]="true" [isredirectionPath]="false"
    [sweetLoadingInitStatus]="false"></app-initial-list>
<!-- cuentas contrato asociadas -->

<!-- Listado de solicitudes asociadas -->
<app-initial-list [showButtonFiltrer]="showButtonFiltrer" [initCardHeaderStatus]="initCardHeaderStatus"
    [initCardHeaderIcon]="initCardHeaderIcon" [dtTitles]="dtTitlesSolicitudesAsociadas"
    [routeLoadDataTablesService]="routeLoadDataTablesServiceSolicitudesAsociadas"
    [initCardHeaderTitle]="initCardHeaderTitleSolicitudesAsociadas"
    (selectedRowsEmiter)="selectedRowsReceiveData($event)" [routeData]="'asociar-solicitudes'" [NoDecrypt]="true"
    [isredirectionPath]="false" [sweetLoadingInitStatus]="false"></app-initial-list>
<!-- Listado de solicitudes asociadas -->

<div class="d-flex flex-row ml-3 mb-2 justify-content-center w-100">
    <button class="btn btn-primary text-center modal-button" (click)="openDialogSGO()" *ngIf="avisoSGOBoolean">Consultar
        aviso SGO</button>
    <button class="btn btn-primary text-center modal-button" (click)="openDialogSAP()" *ngIf="avisoSAPBoolean">Consultar
        aviso SAP</button>
</div>

<!-- menu flotante de acciones -->
<app-floating-button [menuButtons]="menuButtons" (menuEmiterData)="menuReceiveData($event)"></app-floating-button>
<!-- menu flotante de acciones -->

<!-- Modal Inclusion en expediente -->
<app-include-in-file *ngIf="statusModalIncludeInFile" [eventClickButtonSelectedData]="[this.currentItem]"
    (closeIncludeInFileEmiter)="transactionIncludeFiles($event)"></app-include-in-file>
<!-- Modal Inclusion en expediente -->